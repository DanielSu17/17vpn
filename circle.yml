## circle.yml configs circle CI
machine:
  services:
    - docker

dependencies:
  override:
    # Install python dependencies
    - pip install -r ./circle/requirements.txt

test:
  override:
    # YAML & JSON sytax verify
    - ./circle/syntax_checker.py

notify:
  # Notify phabricator about result
  webhooks:
    - url: https://media17.phacility.com/harbormaster/hook/circleci/

deployment:
  master:
    branch: master
    commands:
      # ref: https://github.com/17media/api/blob/master/infra/deploy/configs/pushToEtcd.go
      - wget https://s3-us-west-2.amazonaws.com/17scripts/configs_push_to_etcd/pushToEtcd-linux
      - chmod +x pushToEtcd-linux
      - ./pushToEtcd-linux --commit_id "$(git rev-parse --short HEAD)"
